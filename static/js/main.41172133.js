(()=>{"use strict";var e={8465:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ue});n(2462);var r=n(1232),o=n(5705),l=n(9688),a=n(2152),i=n(4942),s=n(6328),c=n(4246),d=n(2010),u=n(937);const f={light:{text:"#333",accentBackground:"#eee",accentBackgroundAlt:"#ddd",background:"#fff",tint:"#555",tabIconDefault:"#333",tabIconSelected:"#333"},dark:{text:"#ccc",accentBackground:"#222",accentBackgroundAlt:"#333",background:"#000",tint:"#aaa",tabIconDefault:"#ccc",tabIconSelected:"#ccc"}};var h=n(885),y=n(519),m=n(4214),v=n(6771),x=n(5004),p=n(9385),g=n(1054),b=n(3224),j=n(7850),w=n(6184),S=n(9664),O=n(2251),P=n(6028),C=n(5326),k=n(5148),N=n(1193),_=n(7994),I=n(1236),B=(0,x.createContext)({scroll:{x:{value:0}},hScrollRef:{current:null},layout:{height:0,width:0}}),D=n(2629),V={code:"function anonymous(){const{scrollCtx,window,from,to,windowDelta}=this._closure;if(!(scrollCtx.scroll.x.value+window<from||scrollCtx.scroll.x.value>to)){const scale=Math.max(0,Math.min(1,(scrollCtx.scroll.x.value-from)/windowDelta));if(windowDelta>=0){return{flexGrow:scale};}else{return{flexGrow:1-scale};}}else{return{flexGrow:0};}}",location:"/source-files/src/components/sliding-content.tsx"};function A(e){var t=e.from,n=e.to,r=e.window,o=e.children,l=(0,x.useContext)(B),a=n-t-r,i=(0,_.useAnimatedStyle)(function(){var e=function(){if(l.scroll.x.value+r<t||l.scroll.x.value>n)return{flexGrow:0};var e=Math.max(0,Math.min(1,(l.scroll.x.value-t)/a));return a>=0?{flexGrow:e}:{flexGrow:1-e}};return e._closure={scrollCtx:l,window:r,from:t,to:n,windowDelta:a},e.__initData=V,e.__workletHash=8733979568966,e}());return(0,D.jsxs)(p.default,{style:{flexDirection:"row"},children:[(0,D.jsx)(I.default,{style:i}),(0,D.jsx)(p.default,{style:{flex:-1,maxWidth:.8*l.layout.width},children:o})]})}var E={code:"function anonymous(){const{runOnJS,setIsVisible,scrollCtx,beginVisibilityAt,endVisibilityAt}=this._closure;runOnJS(setIsVisible)(!(scrollCtx.scroll.x.value<beginVisibilityAt||scrollCtx.scroll.x.value>endVisibilityAt));}",location:"/source-files/src/components/composition-node-inspector.tsx"},J=function(e){var t,n=e.node,o=e.color,l=(0,u.default)(),a=f[null!=l?l:"light"],i=(0,r.useSafeAreaInsets)(),s=(0,x.useContext)(B),c=a.accentBackgroundAlt;o===a.accentBackground?(o=a.accentBackground,t=c):(o=c,t=a.accentBackground);var d=(0,x.useState)(!1),y=(0,h.default)(d,2),m=y[0],v=y[1],b=(0,x.useState)(!0),j=(0,h.default)(b,2),w=j[0],S=j[1],O=s.layout.width-i.right-i.left,P=n.start-O,_=n.end;(0,k.useDerivedValue)(function(){var e=function(){(0,N.runOnJS)(S)(!(s.scroll.x.value<P||s.scroll.x.value>_))};return e._closure={runOnJS:N.runOnJS,setIsVisible:S,scrollCtx:s,beginVisibilityAt:P,endVisibilityAt:_},e.__initData=E,e.__workletHash=0xbf6189c1869,e}());var I=Object.keys(n.element)[0]+(n.name?"("+n.name+")":""),V=JSON.stringify(Object.values(n.element)[0]).replace(/[:,]/g,(function(e){return e+" "})),J=n.end-n.start;return(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)(p.default,{style:{minHeight:35,backgroundColor:o,borderRadius:20,marginBottom:7,alignSelf:"flex-start",width:J},children:[(0,D.jsx)(H,{condition:w,wrapper:function(e){return(0,D.jsx)(C.default,{onPress:function(){return v(!m)},onLongPress:function(){return console.log(n.element)},children:e})},children:(0,D.jsx)(p.default,{style:M.container,children:(0,D.jsx)(H,{condition:w,wrapper:function(e){return(0,D.jsx)(A,{from:n.start,to:n.end,window:s.layout.width-i.right-i.left,children:e})},children:(0,D.jsxs)(p.default,{style:{flexDirection:"row",flex:-1},children:[(0,D.jsx)(z,{icon:"backward",isVisible:w,style:{color:a.text},onPress:function(){var e;return null==(e=s.hScrollRef.current)?void 0:e.scrollTo({x:n.start-s.layout.width,animated:!0})}}),(0,D.jsxs)(p.default,{style:{flex:-1,flexDirection:"column",paddingHorizontal:3},children:[(0,D.jsx)(g.default,{style:{color:a.text},children:I+("null"===V?"":": "+V)}),(0,D.jsx)(g.default,{style:{color:a.text},children:n.start+".."+n.end}),(0,D.jsx)(p.default,{style:{flexDirection:"row"}})]}),(0,D.jsx)(z,{icon:"forward",isVisible:w,style:{color:a.text},onPress:function(){var e;return null==(e=s.hScrollRef.current)?void 0:e.scrollTo({x:n.end,animated:!0})}})]})})})}),m?(0,D.jsx)(T,{node:n,color:t}):null]})})};const R=x.memo(J);var T=x.memo((function(e){var t,n=e.node,r=e.color,o=null==(t=n.children)?void 0:t.reduce((function(e,t){if(0===e.length)e.push([t]);else if(t.end-t.start<50||t.start<n.start||t.end>n.end);else{var r=e.find((function(e){return e.every((function(e){return e.end<=t.start}))||e.every((function(e){return e.start>=t.end}))}));r?(r.push(t),r.sort((function(e,t){return e.start-t.start}))):e.push([t])}return e}),[]);return null==o?void 0:o.map((function(e,t){return(0,D.jsx)(p.default,{style:{flexDirection:"row"},children:e.reduce((function(e,t,o,l){var a=0;return(a=0!==o?t.start-l[o-1].end:t.start-n.start)>0&&e.push((0,D.jsx)(p.default,{style:{width:a}},o)),e.push((0,D.jsx)(J,{node:t,color:r},JSON.stringify(n.element)+".child"+o)),e}),[])},JSON.stringify(n.element)+".childrenRow"+t)}))})),H=x.memo((function(e){var t=e.condition,n=e.wrapper,r=e.children;return t?n(r):r})),z=x.memo((function(e){var t=e.icon,n=e.onPress,r=e.isVisible,o=e.style;return(0,D.jsx)(D.Fragment,{children:r?(0,D.jsx)(C.default,{hitSlop:12,onPress:n,children:(0,D.jsx)(p.default,{style:{flex:1,paddingHorizontal:4,justifyContent:"center"},children:(0,D.jsx)(s.default,{size:12,name:t,style:o})})}):(0,D.jsx)(p.default,{style:{height:12,width:20}})})})),M=d.default.create({container:{justifyContent:"center",paddingHorizontal:5,paddingVertical:5}}),F={code:"function anonymous(event){const{scrollCtx}=this._closure;scrollCtx.scroll.x.value=event.contentOffset.x;}",location:"/source-files/src/components/composition-inspector.tsx"},G={code:"function anonymous(event){const{scrollCtx}=this._closure;scrollCtx.scroll.x.value=event.contentOffset.x;}",location:"/source-files/src/components/composition-inspector.tsx"},W={code:"function anonymous(event){const{scrollCtx}=this._closure;scrollCtx.scroll.x.value=event.contentOffset.x;}",location:"/source-files/src/components/composition-inspector.tsx"};function L(e){var t=e.composition,n=(0,u.default)(),r=f[null!=n?n:"light"],o=(0,x.useState)(0),l=(0,h.default)(o,2),a=l[0],i=l[1],s=(0,x.useState)(0),c=(0,h.default)(s,2),d=c[0],y=c[1],m=(0,j.useAnimatedRef)(),v={scroll:{x:(0,w.useSharedValue)(0)},hScrollRef:m,layout:{height:d,width:a}},p=(0,S.useAnimatedScrollHandler)({onScroll:function(){var e=function(e){v.scroll.x.value=e.contentOffset.x};return e._closure={scrollCtx:v},e.__initData=F,e.__workletHash=4961992336696,e}(),onEndDrag:function(){var e=function(e){v.scroll.x.value=e.contentOffset.x};return e._closure={scrollCtx:v},e.__initData=G,e.__workletHash=4961992336696,e}(),onMomentumEnd:function(){var e=function(e){v.scroll.x.value=e.contentOffset.x};return e._closure={scrollCtx:v},e.__initData=W,e.__workletHash=4961992336696,e}()});return(0,D.jsx)(O.default,{horizontal:!0,ref:m,onScroll:p,scrollEventThrottle:6,onLayout:function(e){v.layout.height=e.nativeEvent.layout.height,v.layout.width=e.nativeEvent.layout.width,y(e.nativeEvent.layout.height),i(e.nativeEvent.layout.width)},style:{backgroundColor:r.background},children:(0,D.jsx)(P.SafeAreaView,{edges:["left","right"],children:(0,D.jsx)(b.default,{nestedScrollEnabled:!0,children:(0,D.jsx)(P.SafeAreaView,{edges:["top"],children:(0,D.jsx)(B.Provider,{value:v,children:(0,D.jsx)(R,{node:t.tree,color:r.accentBackground})})})})})})}const K={get:function(e){if("examples/simple"===e)return n(9680)}};function U(e){var t,n=e.route,r=(0,x.useState)(),o=(0,h.default)(r,2),l=o[0],a=o[1],i=(0,x.useState)(),s=(0,h.default)(i,2),c=s[0],d=s[1],b=(0,u.default)(),j=f[null!=b?b:"light"];if((null==(t=n.params)?void 0:t.composition)!==c){var w;if(null!=(w=n.params)&&w.composition.startsWith("examples/")){var S=K.get(n.params.composition);a(JSON.stringify(S))}else{var O;y.default.getItem(null==(O=n.params)?void 0:O.composition).then((function(e){if(e){var t=v.default.ungzip(m.Buffer.from(e,"base64"),{to:"string"});a(t)}}))}d(n.params.composition)}return l?(0,D.jsx)(L,{composition:JSON.parse(l)}):(0,D.jsx)(p.default,{style:[q.container,{backgroundColor:j.background}],children:(0,D.jsx)(g.default,{style:{color:j.text,fontWeight:"bold",padding:20},children:"No file loaded."})})}var q=d.default.create({container:{alignItems:"center",flex:1,justifyContent:"center"}}),Q=n(5861),X=n(387),Y=n(7113),Z=n(2684);function $(e){var t=e.navigation,n=(0,u.default)(),r=(0,x.useState)(),o=(0,h.default)(r,2),l=o[0],i=o[1],s=(0,x.useRef)(-1),c=f[null!=n?n:"light"],d=function(){var e=(0,Q.default)((function*(){var e,n=yield X.getDocumentAsync({});if(null!=n&&null!=(e=n.assets)&&e.length){var r,o=n.assets[0];try{if("web"===a.default.OS){var l=yield fetch(o.uri);r=yield l.json()}else{if((yield Y.getInfoAsync(o.uri)).exists){var c=yield Y.readAsStringAsync(o.uri,{encoding:Z.EncodingType.UTF8});r=JSON.parse(c)}}try{ee(r)}catch(f){throw new Error("Invalid composition JSON format: "+f.toString())}if(r){var d=m.Buffer.from(v.default.gzip(JSON.stringify(r))).toString("base64");s.current=(s.current+1)%10;var u="composition"+s.current;y.default.setItem(u,d),t.navigate("Inspect",{composition:u})}i("")}catch(f){i(f.toString())}}}));return function(){return e.apply(this,arguments)}}();return(0,D.jsxs)(p.default,{style:[ne.container,{backgroundColor:c.background}],children:[(0,D.jsx)(C.default,{onPress:d,children:(0,D.jsx)(p.default,{style:[ne.button,{backgroundColor:c.accentBackground}],children:(0,D.jsx)(g.default,{style:{color:c.text,fontWeight:"bold"},children:"Open File"})})}),(0,D.jsx)(g.default,{style:{color:c.text,fontWeight:"bold",padding:20},children:l})]})}var ee=function(e){e.options.ticks_per_beat,te(e.tree)},te=function e(t){var n;t.element,t.start,t.end,t.seed,t.rendered,t.element,null==(n=t.children)||n.forEach((function(t){return e(t)}))},ne=d.default.create({container:{alignItems:"center",flex:1,justifyContent:"center"},separator:{height:1,marginVertical:30,width:"80%"},title:{fontSize:20,fontWeight:"bold"},button:{paddingVertical:10,paddingHorizontal:20,borderRadius:20}});function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var oe=(0,c.default)();function le(e){return(0,D.jsx)(s.default,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({size:28,style:ie.tabBarIcon},e))}function ae(e){e.navigation;var t=(0,u.default)(),n=f[null!=t?t:"light"];return(0,D.jsxs)(oe.Navigator,{screenOptions:{tabBarStyle:{backgroundColor:n.accentBackground},tabBarItemStyle:{backgroundColor:n.accentBackground},tabBarActiveTintColor:n.tabIconSelected},children:[(0,D.jsx)(oe.Screen,{name:"Open",component:$,options:{title:"Open",tabBarIcon:function(e){var t=e.color;return(0,D.jsx)(le,{name:"upload",color:t})},headerShown:!1}}),(0,D.jsx)(oe.Screen,{name:"Inspect",component:U,options:{title:"Inspector",tabBarIcon:function(e){var t=e.color;return(0,D.jsx)(le,{name:"code",color:t})},headerShown:!1}})]})}var ie=d.default.create({headerRight:{marginRight:15},tabBarIcon:{marginLeft:-5,marginBottom:-3}}),se=(0,l.default)(),ce={prefixes:"web"!==a.default.OS?["http://*","https://*"]:[],config:{screens:{TabNavigator:{path:"/redact-composer-inspector",screens:{Open:{path:"open"},Inspect:{path:"inspect"}}},NotFound:"*"}}};function de(){return(0,D.jsx)(o.default,{linking:ce,children:(0,D.jsx)(se.Navigator,{children:(0,D.jsx)(se.Screen,{name:"TabNavigator",component:ae,options:{headerShown:!1}})})})}function ue(){return(0,D.jsx)(r.SafeAreaProvider,{children:(0,D.jsx)(de,{})})}},9680:e=>{e.exports=JSON.parse('{"options":{"ticks_per_beat":480},"tree":{"element":{"CompositionRoot":null},"start":0,"end":7680,"seed":17393937693119678000,"rendered":true,"children":[{"element":{"Chord":"I"},"start":0,"end":960,"seed":12363179419697046000,"rendered":true},{"element":{"Chord":"IV"},"start":960,"end":1920,"seed":5774871497953457000,"rendered":true},{"element":{"Chord":"V"},"start":1920,"end":2880,"seed":5224139266359379000,"rendered":true},{"element":{"Chord":"I"},"start":2880,"end":3840,"seed":11397469841477460000,"rendered":true},{"element":{"Chord":"I"},"start":3840,"end":4800,"seed":8252136401401293000,"rendered":true},{"element":{"Chord":"IV"},"start":4800,"end":5760,"seed":6165483944290485000,"rendered":true},{"element":{"Chord":"V"},"start":5760,"end":6720,"seed":9172308219386322000,"rendered":true},{"element":{"Chord":"I"},"start":6720,"end":7680,"seed":10980428154008924000,"rendered":true},{"element":{"Part":[{"PlayChords":null},"Instrument"]},"start":0,"end":7680,"seed":6256104785840586000,"rendered":true,"children":[{"element":{"PlayNote":{"note":60,"velocity":95}},"start":0,"end":960,"seed":15638844320495602000,"rendered":true},{"element":{"PlayNote":{"note":64,"velocity":91}},"start":0,"end":960,"seed":7936330478102024000,"rendered":true},{"element":{"PlayNote":{"note":67,"velocity":92}},"start":0,"end":960,"seed":10320911685981751000,"rendered":true},{"element":{"PlayNote":{"note":60,"velocity":100}},"start":960,"end":1920,"seed":5798829880953256000,"rendered":true},{"element":{"PlayNote":{"note":65,"velocity":100}},"start":960,"end":1920,"seed":7801110803159286000,"rendered":true},{"element":{"PlayNote":{"note":69,"velocity":94}},"start":960,"end":1920,"seed":3001840026229646000,"rendered":true},{"element":{"PlayNote":{"note":62,"velocity":92}},"start":1920,"end":2880,"seed":16787450695753470000,"rendered":true},{"element":{"PlayNote":{"note":67,"velocity":97}},"start":1920,"end":2880,"seed":6502288544590151000,"rendered":true},{"element":{"PlayNote":{"note":71,"velocity":102}},"start":1920,"end":2880,"seed":5155854643391926000,"rendered":true},{"element":{"PlayNote":{"note":60,"velocity":108}},"start":2880,"end":3840,"seed":7106590092348918000,"rendered":true},{"element":{"PlayNote":{"note":64,"velocity":99}},"start":2880,"end":3840,"seed":3223725538137612000,"rendered":true},{"element":{"PlayNote":{"note":67,"velocity":83}},"start":2880,"end":3840,"seed":15084532723388850000,"rendered":true},{"element":{"PlayNote":{"note":60,"velocity":98}},"start":3840,"end":4800,"seed":210657710641928800,"rendered":true},{"element":{"PlayNote":{"note":64,"velocity":82}},"start":3840,"end":4800,"seed":13065029163680053000,"rendered":true},{"element":{"PlayNote":{"note":67,"velocity":90}},"start":3840,"end":4800,"seed":7723903622493186000,"rendered":true},{"element":{"PlayNote":{"note":60,"velocity":102}},"start":4800,"end":5760,"seed":13768486227819168000,"rendered":true},{"element":{"PlayNote":{"note":65,"velocity":88}},"start":4800,"end":5760,"seed":5008564142852735000,"rendered":true},{"element":{"PlayNote":{"note":69,"velocity":91}},"start":4800,"end":5760,"seed":4398878727211215000,"rendered":true},{"element":{"PlayNote":{"note":62,"velocity":88}},"start":5760,"end":6720,"seed":75476441418534750,"rendered":true},{"element":{"PlayNote":{"note":67,"velocity":93}},"start":5760,"end":6720,"seed":11554915792464521000,"rendered":true},{"element":{"PlayNote":{"note":71,"velocity":107}},"start":5760,"end":6720,"seed":11165073617277692000,"rendered":true},{"element":{"PlayNote":{"note":60,"velocity":100}},"start":6720,"end":7680,"seed":11678918496853303000,"rendered":true},{"element":{"PlayNote":{"note":64,"velocity":85}},"start":6720,"end":7680,"seed":15813751711766837000,"rendered":true},{"element":{"PlayNote":{"note":67,"velocity":98}},"start":6720,"end":7680,"seed":1604024895900818000,"rendered":true}]},{"element":{"Key":{"tonic":0,"scale":"Major","mode":"Ionian"}},"start":0,"end":7680,"seed":14889298026868625000,"rendered":true}]}}')}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var l=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(l.exports,l,l.exports,n),l.loaded=!0,l.exports}n.m=e,(()=>{var e=[];n.O=(t,r,o,l)=>{if(!r){var a=1/0;for(d=0;d<e.length;d++){for(var[r,o,l]=e[d],i=!0,s=0;s<r.length;s++)(!1&l||a>=l)&&Object.keys(n.O).every((e=>n.O[e](r[s])))?r.splice(s--,1):(i=!1,l<a&&(a=l));if(i){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[r,o,l]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/redact-composer-inspector/",(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,l,[a,i,s]=r,c=0;if(a.some((t=>0!==e[t]))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(s)var d=s(n)}for(t&&t(r);c<a.length;c++)l=a[c],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(d)},r=self.webpackChunkweb=self.webpackChunkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[441],(()=>n(6271)));r=n.O(r)})();
//# sourceMappingURL=main.41172133.js.map